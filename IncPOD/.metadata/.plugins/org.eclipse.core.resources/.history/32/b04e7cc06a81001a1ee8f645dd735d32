import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.Iterator;
import java.util.Scanner;

import algorithms.hybrid.Incpod;
import input.Input;
import input.InputIterationException;
import input.OriginPOD;
import input.ParsedColumn;
import input.RelationalInput;
import pod.pointOD.PointOD;
import pod.pointOD.PointODSet;
import predicates.PredicateBuilder;


public class Main{

	public static void main(String[] args) throws Exception {
		// TODO Auto-generated method stub
		String line ="incpod\\dataset\\ncvoter_18_1m.csv";    
		File fileq = new File(line);
		String line1 ="incpod\\dataset\\ncv300k.txt";    
		File od = new File(line1);
		RelationalInput data = new RelationalInput(fileq);
		double alpha = 0.4;
		int n=300000;
		int m=6000;
		int size=m;
		Input input = new Input(data,n+m);

		PredicateBuilder predicates = new PredicateBuilder(input);
		OriginPOD origin=new OriginPOD(od,input.getColumns());
		
		Incpod incpod = new Incpod();
		System.out.println("now is incpod for od"); 
		System.out.println("total constraints size "+origin.total.size());
		System.out.println("od size "+origin.getod().size());
		System.out.println("fd size "+origin.getfd().size());
		System.out.println("ucc size "+origin.getucc().size());
		PointODSet dcs = incpod.run(input,predicates,origin,alpha,n,m,size);
		System.out.println("total used time: "+ incpod.time+ "ms"); 

		System.out.println("new ods size : "+dcs.size());
	}
}
